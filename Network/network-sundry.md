### 1. http/1.0, http/1.1, http/2.0, http/3.0

- http/0.9: 1991年发布，及其简单，只有一个 get 命令;
- http/1.0: 1996年5月发布，增加了大量内容;
- http/1.1: 1997年1月发布，进一步完善 http 协议;
- SPDY: 2009年有 Google 发布，主要解决 http/1.1 效率不高的问题;
- http/2.0: 2015年借鉴SPDY的 http/2 发布;

客户端可以在TCP三次握手第三个报文段中捎带HTTP请求，节省资源。

影响一个http网络请求的因素主要有两个，就是带宽和延迟：
- 带宽：网络带宽指单位时间内传输的数据量，是数据的传输能力。随着网络基础建设较为完善，基本不用担心带宽影响网速。
- 延迟：
  1. 浏览器阻塞(head of line blocking ?): 浏览器对于同一个域名，同时只能有6个连接(根据浏览器内核可能有所差异)，超过浏览器最大连接数限制，后续请求就会被阻塞。这也是为何一些站点会有多个静态资源CDN域名的原因之一。
  2. DNS查询：解析域名为IP,一般使用DNS缓存来减少这个时间。
  3. 建立连接：http基于TCP,浏览器最开也要在第三次握手时才能携带HTTP请求报文，达到真正的连接建立。这些连接若无法复用则会导致每次请求都经历三次握手和慢启动，客户端和服务器也需要不停的分配和回收TCP缓存空间以及变量。三次握手在高延迟场景下影响比较明显，慢开始则对文件类大请求影响较大。

#### 1.1 http/1.0
http/1.0 规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都与服务器建立一个TCP连接,服务器完成请求处理后立即断开TCP连接。它的主要问题在于：
1. 一个网页中需要对图片，JS文件，CSS文件发出多个请求，而对每个请求，都需要建立新的连接。
2. 而TCP连接的建立和释放相对费时，且每次建立TCP连接之后都要执行慢开始算法。
3. TCP 连接建立时，客户机和服务器都需要为其分配缓存空间和变量并在连接释放时回收他们。当请求数量大时，这也会影响到客户机和服务器的性能。

http/1.0 中持续连接是关闭的，需要在http header 中加入：`connection: keep-alive; keep-alive: timeout = 5, max = 1000`类似的内容才能持续连接。而 http/1.1 中默认启用持续连接，加入 `connection: close` 才关闭。connection 在 request 和 response 的 header 中均可出现，只要其值为 `close`,则该连接会在请求处理完毕后释放调。

http/1.1 之前的 http 版本的默认连接都是非持久连接。为此，若想在旧版本的 http 协议上维持持续连接，则需要指定 `Connection` 首部字段的置为 `keep-alive`。 —— 《图解HTTP》

#### 1.2 http/1.1
http/1.1 进一步完善了 http 协议，是目前最流行的版本。
它和 http/1.0 的**主要**区别在于：
1. 缓存处理： 引入了更多的缓存控制策略。
2. 错误状态处理：新增了24个错误状态相应码，如409, 410 等。
3. 范围请求：http/1.0 中，存在一些浪费带宽的现象，如若客户端只需某个对象的一部分，服务器却会将整个对象送过来，且不支持断点续传功能。http/1.1 在请求头引入了 range 头域，它允许值请求资源的某个部分(返回码是206),这样就方便了开发者自由的选择以便充分利用带宽和连接，支持断点续传。
4. Host头：http/1.0 中认为每台服务器都绑定一个唯一的IP地址，因此请求的URL中并没有传递主机名。但随着技术发展，在一台物理服务器上可以存在多个虚拟主机，且它们共享一个IP地址。http/1.1的request 和 response 都支持 host 字段，且若 request 中没有 host 字段会报错(400 bad request)。使用 host 字段，可以将请求发往同一台服务器上的不同网站，为虚拟主机的兴起打下了基础。
5. 持久连接：http/1.1 最大的变化是引入持久连接(http/1.0似乎也可以有，但不是规范)，默认开启 `connection: keep-alive`,即 tcp 连接默认不关闭，可以被多个请求复用。

客户端和服务器发现对方一段时间没有活动，就可以主动关闭连接。但规范的做法是客户端在最后一个请求时，发送 `Connection: close`,明确要求服务器关闭TCP连接。
6. 管道机制(pipelining): 在同一个TCP连接中，客户端可以同时发送多个请求(流水线方式)。
![http/1.x-connection](/Image/http1.x-connection.png)

需要注意的是 http 的连接管理适用于两个连续节点之间的连接，如 hop-by-hop, 而不是 end-to-end。如 `Connection`和`Keep-Alive` 就是 `hop-by-hop` 协议头，它们的值是可以被中间结点修改的。

虽然 http/1.1 使用了持久连接和管道机制来复用TCP连接且同时发送多个请求，但所有的数据通信都是按次序完成的，服务器只有处理完一个响应，才会处理下一个响应。因此，有时候若某个请求的处理特别慢，则之后的请求都得排队等着，这成为"队头阻塞(head-of-line-blocking)"。虽然浏览器可以针对单个域名开启6个左右的连接并通过各个连接分别发送请求，能在一定程度上解决这个问题，但每个连接中依然会存在这个问题。

参考：
- [如何优雅的谈论HTTP/1.0，http/1.1，http/2.0](https://www.jianshu.com/p/52d86558ca57)
- [《图解HTTP》](https://kingyinliang.github.io/PDF/%E5%9B%BE%E8%A7%A3HTTP+%E5%BD%A9%E8%89%B2%E7%89%88.pdf)
- [http/1.0、http/1.1、http/2、https](https://zhuanlan.zhihu.com/p/43787334)
- [http/1.x 的连接管理-MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Connection_management_in_HTTP_1.x)
- [http/1.x 的缺点总结](https://segmentfault.com/a/1190000013519925)

#### 1.3 https
- SSL/1.0: 1994年NetScape 公司设计，未发布；
- SSL/2.0: 1995年NetScape 公司发布，但存在严重漏洞；
- SSL/3.0: 1996年NetScape 公司发布，得到大规模应用；
- TLS/1.0: 1999年互联网标准化组织(ISOC)接替NetScape 公司，发布SSL的升级版TLS/1.0；
- TLS/1.1: 2006年发布；
- TLS/1.2: 2008年发布；
- TLS/1.2修订版:2011年发布；

HTTP 在基本的TCP/IP协议栈上发送信息，网景公司在此基础上创建了一个额外的加密传输层：SSL。SSL允许通过加密来保证服务器和客户端之间交换消息的真实性，SSL在标准化的道路上最终成为TLS。

#### 1.4 http/2.0
http/2.0 是一种安全高效的下一代 http 传输协议，安全是因为 http/2.0 建立在 https 协议的基础上，高效是因为它通过二进制分帧来进行数据传输。

参考：
- [深入理解 http2.0 协议，看这篇就够了](https://juejin.im/entry/5dba82c3e51d452a17370818)